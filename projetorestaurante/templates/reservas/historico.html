{% extends "staff_base.html" %}
{% load static %}

{% block title %}Histórico de Reservas{% endblock %}

{% block main_content %} {# <-- Mudou de content para main_content #}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Histórico de Reservas</h2>
    <a href="{% url 'gerenciar_reservas' %}" class="btn btn-sm btn-outline-secondary">&larr; Voltar para Reservas Ativas</a>
</div>
<div class="card shadow-sm">
    <div class="card-body">
        <table class="table table-striped table-hover mb-0 align-middle">
            <thead><tr><th>Cliente</th><th>Data</th><th>Hora</th><th>Pessoas</th><th>Status Final</th></tr></thead>
            <tbody>
                {% for reserva in lista_historico %}
                <tr>
                    <td>{% if reserva.usuario %} {{ reserva.usuario.get_full_name|default:reserva.usuario.username }} {% else %} <span class="text-muted fst-italic">Res. Antiga</span> {% endif %}</td>
                    <td>{{ reserva.data|date:"d/m/Y" }}</td><td>{{ reserva.hora|time:"H:i" }}</td><td>{{ reserva.quantidade_pessoas }}</td>
                    <td>
                        {% if reserva.status == 'CONFIRMADA' %} <span class="badge bg-secondary">{{ reserva.get_status_display }} (Realizada)</span>
                        {% elif reserva.status == 'CANCELADA' %} <span class="badge bg-danger">{{ reserva.get_status_display }}</span>
                        {% else %} <span class="badge bg-light text-dark">{{ reserva.get_status_display }}</span> {% endif %}
                    </td>
                </tr>
                {% empty %} <tr> <td colspan="5" class="text-center text-muted py-4">Nenhum histórico encontrado.</td> </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}